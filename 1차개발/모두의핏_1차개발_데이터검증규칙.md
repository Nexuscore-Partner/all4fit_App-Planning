# 모두의 핏 1차 개발 데이터 검증 규칙

## 📋 개요
모두의 핏 앱의 모든 데이터 입력에 대한 검증 규칙을 정리한 문서입니다.

## 🔐 1. 인증 시스템 검증 규칙

### 1.1 회원가입

#### 1.1.1 사용자 타입 선택
- **필수 여부**: 필수
- **값 범위**: 'general' | 'instructor' | 'operator'
- **검증 로직**: 
  - 반드시 하나의 타입 선택 필수
  - 선택하지 않으면 다음 단계 진행 불가

#### 1.1.2 이름 입력
- **필수 여부**: 필수
- **길이**: 2-10자
- **허용 문자**: 한글, 영문, 공백
- **제한 문자**: 특수문자, 숫자 불허용
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z\s]{2,10}$`

#### 1.1.3 이메일 입력
- **필수 여부**: 필수
- **형식**: RFC 5322 표준 준수
- **검증 로직**: 
  - 정규식: `^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`
  - 중복 확인 필수
  - 도메인 유효성 검증

#### 1.1.4 전화번호 입력
- **필수 여부**: 필수
- **형식**: 010-XXXX-XXXX
- **검증 로직**: 
  - 정규식: `^010-\d{4}-\d{4}$`
  - 숫자만 허용
  - 11자리 고정

#### 1.1.5 SMS 인증번호
- **필수 여부**: 필수
- **길이**: 6자리
- **형식**: 숫자만
- **유효시간**: 3분
- **검증 로직**: 
  - 정규식: `^\d{6}$`
  - 대소문자 구분 없음
  - 유효시간 초과 시 재발송

#### 1.1.6 비밀번호 설정
- **필수 여부**: 필수
- **길이**: 8-20자
- **필수 포함**: 영문 대소문자, 숫자, 특수문자 조합
- **제한**: 
  - 연속된 문자 3개 이상 불허용
  - 공백 불허용
  - 이전 비밀번호와 동일 불허용
- **검증 로직**: 
  - 정규식: `^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$`

#### 1.1.7 비밀번호 확인
- **필수 여부**: 필수
- **검증 로직**: 
  - 비밀번호와 일치 여부 확인
  - 대소문자 구분

#### 1.1.8 약관동의
- **필수 여부**: 
  - 서비스 이용약관: 필수
  - 개인정보처리방침: 필수
  - 위치기반 서비스 이용약관: 필수
  - 마케팅 수신: 선택
- **검증 로직**: 
  - 필수 약관 미동의 시 진행 불가
  - 위치기반 서비스 약관은 위치 서비스 이용 시 필수
  - 선택 약관은 선택사항

#### 1.1.9 닉네임 설정
- **필수 여부**: 필수
- **길이**: 2-10자
- **허용 문자**: 한글, 영문, 숫자
- **제한 문자**: 특수문자, 공백 불허용
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9]{2,10}$`
  - 중복 확인 필수

#### 1.1.10 생년월일 입력
- **필수 여부**: 필수
- **입력 방식**: 년/월/일 각각 텍스트 입력
- **입력 필드**: 
  - 년도: 4자리 숫자 (YYYY)
  - 월: 2자리 숫자 (MM)
  - 일: 2자리 숫자 (DD)
- **제한**: 만 14세 이상
- **검증 로직**: 
  - 년도: 1900-현재년도
  - 월: 01-12
  - 일: 01-31 (월별 유효 일수 확인)
  - 유효한 날짜 조합 확인
  - 현재 날짜 기준 만 14세 이상

#### 1.1.11 성별 선택
- **필수 여부**: 필수
- **값 범위**: 'male' | 'female'
- **검증 로직**: 
  - 정확한 값 선택 필수

#### 1.1.12 거주지역 설정
- **필수 여부**: 필수
- **형식**: 시/도, 구/군 선택
- **검증 로직**: 
  - 유효한 지역 코드 확인
  - 시/도, 구/군 모두 선택 필수

### 1.2 로그인

#### 1.2.1 이메일/전화번호 로그인
- **필수 여부**: 필수
- **형식**: 이메일 또는 전화번호
- **검증 로직**: 
  - 이메일 형식 또는 전화번호 형식 확인
  - 계정 존재 여부 확인
  - 비밀번호 일치 확인

#### 1.2.2 비밀번호 로그인
- **필수 여부**: 필수
- **길이**: 8자 이상
- **검증 로직**: 
  - 비밀번호 해시 비교
  - 계정 활성화 상태 확인

#### 1.2.3 로그인 상태 유지
- **필수 여부**: 선택
- **타입**: boolean
- **검증 로직**: 
  - true/false 값만 허용

### 1.3 비밀번호 관리

#### 1.3.1 비밀번호 찾기 - 이름
- **필수 여부**: 필수
- **길이**: 2-10자
- **허용 문자**: 한글, 영문, 공백
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z\s]{2,10}$`
  - 계정과 일치 여부 확인

#### 1.3.2 비밀번호 찾기 - 전화번호
- **필수 여부**: 필수
- **형식**: 010-XXXX-XXXX
- **검증 로직**: 
  - 정규식: `^010-\d{4}-\d{4}$`
  - 계정과 일치 여부 확인

#### 1.3.3 새 비밀번호 설정
- **필수 여부**: 필수
- **길이**: 8-20자
- **필수 포함**: 영문 대소문자, 숫자, 특수문자 조합
- **검증 로직**: 
  - 정규식: `^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$`
  - 기존 비밀번호와 동일 불허용

## 🏠 2. 홈 탭 검증 규칙

### 2.1 위치 기반 서비스

#### 2.1.1 GPS 좌표
- **필수 여부**: 필수
- **위도 범위**: -90 ~ 90
- **경도 범위**: -180 ~ 180
- **정확도**: 0 이상
- **검증 로직**: 
  - 유효한 좌표 범위 확인
  - GPS 신호 강도 확인

#### 2.1.2 주소 정보
- **필수 여부**: 필수
- **길이**: 1-100자
- **허용 문자**: 한글, 영문, 숫자, 특수문자
- **검증 로직**: 
  - 역지오코딩 결과 확인
  - 유효한 주소 형식 확인

### 2.2 시설 검색

#### 2.2.1 검색 키워드
- **필수 여부**: 필수
- **길이**: 1-50자
- **허용 문자**: 한글, 영문, 숫자, 공백
- **제한 문자**: 특수문자 제한
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s]{1,50}$`
  - 빈 문자열 불허용

#### 2.2.2 검색 카테고리
- **필수 여부**: 선택
- **값 범위**: 유효한 카테고리 코드
- **검증 로직**: 
  - 등록된 카테고리 확인

### 2.3 운동 분야 선택

#### 2.3.1 운동 분야 코드
- **필수 여부**: 필수
- **값 범위**: 
  - 구기: 'ball_sports'
  - 라켓: 'racket_sports'
  - 격투/무술: 'martial_arts'
  - 수상: 'water_sports'
  - 피트니스: 'fitness'
  - 동계: 'winter_sports'
  - 골프/레저: 'golf_leisure'
  - 체대입시/장애인: 'special_programs'
- **검증 로직**: 
  - 유효한 분야 코드 확인

#### 2.3.2 세부 종목 코드
- **필수 여부**: 선택
- **값 범위**: 각 분야별 세부 종목 코드
- **검증 로직**: 
  - 상위 분야와 일치 여부 확인

## 🗺️ 3. 지도 탭 검증 규칙

### 3.1 지도 기반 시설 탐색

#### 3.1.1 지도 중심 좌표
- **필수 여부**: 필수
- **위도 범위**: -90 ~ 90
- **경도 범위**: -180 ~ 180
- **검증 로직**: 
  - 유효한 좌표 범위 확인

#### 3.1.2 반경 설정
- **필수 여부**: 필수
- **범위**: 0.5km ~ 50km
- **단위**: 킬로미터
- **검증 로직**: 
  - 숫자 형식 확인
  - 범위 내 값 확인

#### 3.1.3 줌 레벨
- **필수 여부**: 필수
- **범위**: 1 ~ 20
- **검증 로직**: 
  - 정수 값 확인
  - 범위 내 값 확인

## 💬 4. 커뮤니티 탭 검증 규칙

### 4.1 게시판

#### 4.1.1 게시글 제목
- **필수 여부**: 필수
- **길이**: 1-50자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **제한 문자**: HTML 태그, 스크립트
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,50}$`
  - XSS 방지 필터링

#### 4.1.2 게시글 내용
- **필수 여부**: 필수
- **길이**: 1-1000자
- **허용 문자**: 한글, 영문, 숫자, 공백, 특수문자
- **제한 문자**: HTML 태그, 스크립트
- **검증 로직**: 
  - XSS 방지 필터링
  - 부적절한 내용 필터링
  - 빈 문자열 불허용

#### 4.1.3 게시글 이미지
- **필수 여부**: 선택
- **최대 개수**: 5장
- **파일 크기**: 각 10MB 이하
- **지원 형식**: JPEG, PNG, WebP
- **최대 해상도**: 4096x4096
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 확인
  - 이미지 유효성 확인

#### 4.1.4 게시글 정렬
- **필수 여부**: 필수
- **값 범위**: 'latest' | 'popular' | 'likes'
- **검증 로직**: 
  - 유효한 정렬 옵션 확인

### 4.2 댓글

#### 4.2.1 댓글 내용
- **필수 여부**: 필수
- **길이**: 1-200자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **제한 문자**: HTML 태그, 스크립트
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,200}$`
  - XSS 방지 필터링
  - 스팸 방지 (동일 내용 연속 작성 제한)

#### 4.2.2 댓글 게시글 ID
- **필수 여부**: 필수
- **형식**: ObjectId 또는 UUID
- **검증 로직**: 
  - 유효한 ID 형식 확인
  - 존재하는 게시글 확인

### 4.3 좋아요

#### 4.3.1 좋아요 대상 ID
- **필수 여부**: 필수
- **형식**: ObjectId 또는 UUID
- **검증 로직**: 
  - 유효한 ID 형식 확인
  - 존재하는 게시글/댓글 확인

#### 4.3.2 좋아요 상태
- **필수 여부**: 필수
- **타입**: boolean
- **검증 로직**: 
  - true/false 값만 허용

## 👤 5. 마이페이지 탭 검증 규칙

### 5.1 프로필 관리

#### 5.1.1 프로필 사진
- **필수 여부**: 선택
- **파일 크기**: 10MB 이하
- **지원 형식**: JPEG, PNG, WebP
- **최대 해상도**: 4096x4096
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 확인
  - 이미지 유효성 확인

#### 5.1.2 프로필 수정 - 닉네임
- **필수 여부**: 필수
- **길이**: 2-10자
- **허용 문자**: 한글, 영문, 숫자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9]{2,10}$`
  - 중복 확인 필수
  - 기존 닉네임과 동일 시 통과

#### 5.1.3 프로필 수정 - 생년월일
- **필수 여부**: 필수
- **입력 방식**: 년/월/일 각각 텍스트 입력
- **입력 필드**: 
  - 년도: 4자리 숫자 (YYYY)
  - 월: 2자리 숫자 (MM)
  - 일: 2자리 숫자 (DD)
- **검증 로직**: 
  - 년도: 1900-현재년도
  - 월: 01-12
  - 일: 01-31 (월별 유효 일수 확인)
  - 유효한 날짜 조합 확인

#### 5.1.4 프로필 수정 - 거주지역
- **필수 여부**: 필수
- **형식**: 시/도, 구/군 선택
- **검증 로직**: 
  - 유효한 지역 코드 확인

### 5.2 리뷰 관리

#### 5.2.1 리뷰 평점
- **필수 여부**: 필수
- **범위**: 1-5
- **단위**: 정수
- **검증 로직**: 
  - 1, 2, 3, 4, 5 중 하나만 허용

#### 5.2.2 리뷰 내용
- **필수 여부**: 필수
- **길이**: 1-500자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,500}$`
  - XSS 방지 필터링

#### 5.2.3 리뷰 이미지
- **필수 여부**: 선택
- **최대 개수**: 3장
- **파일 크기**: 각 10MB 이하
- **지원 형식**: JPEG, PNG, WebP
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 확인

### 5.3 문의 관리

#### 5.3.1 문의 유형
- **필수 여부**: 필수
- **값 범위**: 
  - 'general': 일반 문의
  - 'facility': 시설 관련 문의
  - 'technical': 기술적 문제
  - 'account': 계정 관련 문의
- **검증 로직**: 
  - 유효한 유형 코드 확인

#### 5.3.2 문의 제목
- **필수 여부**: 필수
- **길이**: 1-100자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,100}$`

#### 5.3.3 문의 내용
- **필수 여부**: 필수
- **길이**: 1-1000자
- **허용 문자**: 한글, 영문, 숫자, 공백, 특수문자
- **검증 로직**: 
  - XSS 방지 필터링
  - 빈 문자열 불허용

#### 5.3.4 첨부파일
- **필수 여부**: 선택
- **최대 개수**: 3개
- **파일 크기**: 각 10MB 이하
- **지원 형식**: 모든 형식
- **검증 로직**: 
  - 파일 크기 확인
  - 악성 파일 검사

### 5.4 설정

#### 5.4.1 알림 설정
- **필수 여부**: 필수
- **타입**: boolean
- **검증 로직**: 
  - true/false 값만 허용

#### 5.4.2 알림 시간 설정
- **필수 여부**: 선택
- **형식**: HH:MM
- **범위**: 00:00 ~ 23:59
- **검증 로직**: 
  - 정규식: `^([01]?[0-9]|2[0-3]):[0-5][0-9]$`

## 🏢 6. 시설 운영자 기능 검증 규칙

### 6.1 시설 관리

#### 6.1.1 시설명
- **필수 여부**: 필수
- **길이**: 1-50자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,50}$`

#### 6.1.2 시설 주소
- **필수 여부**: 필수
- **길이**: 1-200자
- **허용 문자**: 한글, 영문, 숫자, 공백, 특수문자
- **검증 로직**: 
  - 유효한 주소 형식 확인

#### 6.1.3 시설 연락처
- **필수 여부**: 필수
- **형식**: 02-XXXX-XXXX 또는 010-XXXX-XXXX
- **검증 로직**: 
  - 정규식: `^(0[2-9]{1,2}-\d{3,4}-\d{4})$`

#### 6.1.4 운영시간 및 정보
- **필수 여부**: 필수
- **길이**: 1-500자
- **허용 문자**: 한글, 영문, 숫자, 공백, 특수문자
- **검증 로직**: 
  - XSS 방지 필터링
  - 빈 문자열 불허용

#### 6.1.5 시설 상태
- **필수 여부**: 필수
- **값 범위**: 'active' | 'inactive' | 'closed'
- **상태 설명**:
  - 'active': 정상 영업 중
  - 'inactive': 임시 휴업 중
  - 'closed': 영업 종료/폐업
- **검증 로직**: 
  - 유효한 상태 코드 확인
  - 상태 변경 시 알림 발송

#### 6.1.6 시설 사진
- **필수 여부**: 선택
- **최대 개수**: 10장
- **파일 크기**: 각 10MB 이하
- **지원 형식**: JPEG, PNG, WebP
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 확인

### 6.2 리뷰 관리

#### 6.2.1 리뷰 답글 내용
- **필수 여부**: 필수
- **길이**: 1-300자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,300}$`
  - XSS 방지 필터링

## 🏃 7. 지도자 기능 검증 규칙

### 7.1 문의 답변

#### 7.1.1 문의 답변 내용
- **필수 여부**: 필수
- **길이**: 1-500자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,500}$`
  - XSS 방지 필터링

### 7.2 프로필 관리

#### 7.2.1 자격증 사진
- **필수 여부**: 필수
- **파일 크기**: 10MB 이하
- **지원 형식**: JPEG, PNG, WebP
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 확인
  - 이미지 유효성 확인

#### 7.2.2 자격증 정보
- **필수 여부**: 필수
- **길이**: 1-100자
- **허용 문자**: 한글, 영문, 숫자, 공백, 일부 특수문자
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s.,!?-]{1,100}$`

## 🖥️ 8. 관리자 웹 시스템 검증 규칙

### 8.1 사용자 관리

#### 8.1.1 사용자 상태
- **필수 여부**: 필수
- **값 범위**: 'active' | 'inactive' | 'suspended'
- **검증 로직**: 
  - 유효한 상태 코드 확인

#### 8.1.2 사용자 권한
- **필수 여부**: 필수
- **값 범위**: 'user' | 'operator' | 'instructor' | 'admin'
- **검증 로직**: 
  - 유효한 권한 코드 확인

### 8.2 콘텐츠 관리

#### 8.2.1 리뷰 상태
- **필수 여부**: 필수
- **값 범위**: 'active' | 'reported' | 'deleted'
- **검증 로직**: 
  - 유효한 상태 코드 확인

#### 8.2.2 문의 상태
- **필수 여부**: 필수
- **값 범위**: 'pending' | 'answered' | 'closed'
- **검증 로직**: 
  - 유효한 상태 코드 확인

## 📊 9. 공통 기능 검증 규칙

### 9.1 파일 업로드

#### 9.1.1 이미지 파일
- **지원 형식**: JPEG, PNG, WebP
- **최대 크기**: 10MB
- **최대 해상도**: 4096x4096
- **검증 로직**: 
  - 파일 헤더 확인
  - MIME 타입 확인
  - 이미지 유효성 확인

#### 9.1.2 일반 파일
- **최대 크기**: 10MB
- **제한 파일**: 실행 파일, 스크립트 파일
- **검증 로직**: 
  - 파일 확장자 확인
  - 악성 파일 검사

### 9.2 검색 시스템

#### 9.2.1 검색어
- **길이**: 1-100자
- **허용 문자**: 한글, 영문, 숫자, 공백
- **검증 로직**: 
  - 정규식: `^[가-힣a-zA-Z0-9\s]{1,100}$`
  - XSS 방지 필터링

#### 9.2.2 검색 결과 수
- **범위**: 1-100
- **기본값**: 20
- **검증 로직**: 
  - 숫자 형식 확인
  - 범위 내 값 확인

### 9.3 페이지네이션

#### 9.3.1 페이지 번호
- **범위**: 1 이상
- **기본값**: 1
- **검증 로직**: 
  - 정수 값 확인
  - 1 이상 값 확인

#### 9.3.2 페이지 크기
- **범위**: 1-100
- **기본값**: 20
- **검증 로직**: 
  - 정수 값 확인
  - 범위 내 값 확인

## 🔒 보안 검증 규칙

### 10.1 XSS 방지
- **적용 대상**: 모든 텍스트 입력
- **검증 로직**: 
  - HTML 태그 제거
  - 스크립트 태그 제거
  - 특수문자 이스케이프

### 10.2 SQL Injection 방지
- **적용 대상**: 모든 데이터베이스 쿼리
- **검증 로직**: 
  - 파라미터화된 쿼리 사용
  - 입력값 이스케이프

### 10.3 CSRF 방지
- **적용 대상**: 모든 POST/PUT/DELETE 요청
- **검증 로직**: 
  - CSRF 토큰 확인
  - Referer 헤더 확인

### 10.4 파일 업로드 보안
- **적용 대상**: 모든 파일 업로드
- **검증 로직**: 
  - 파일 형식 확인
  - 파일 크기 제한
  - 악성 파일 검사
  - 업로드 경로 제한

